var C=(s,e,n)=>{if(!e.has(s))throw TypeError("Cannot "+n)};var h=(s,e,n)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,n)};var l=(s,e,n)=>(C(s,e,"access private method"),n);import*as t from"https://cdn.skypack.dev/three@0.132.2";import{OrbitControls as E}from"https://cdn.skypack.dev/three@0.132.2/examples/jsm/controls/OrbitControls.js";const H=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};H();const O=new t.SphereBufferGeometry(.5),W=new t.MeshStandardMaterial({color:43520});new t.Raycaster(new t.Vector3(0,0,0),new t.Vector3(0,0,0),.1,1e3);var m,L,g,T,y,I,B,N;class b{constructor(e){h(this,m);h(this,g);h(this,y);h(this,B);this.scene=e,this.velocity=new t.Vector3(0,0,0),this.acceleration=new t.Vector3(Math.random()*40-20,Math.random()*40-20,Math.random()*40-20),this.mass=.1,this.threeBoid=new t.Mesh(O,W),this.threeBoid.position.set(Math.random()*8-4,Math.random()*8-4,Math.random()*8-4),this.scene.add(this.threeBoid)}getDistance(e){return Math.sqrt((e.threeBoid.position.x-this.threeBoid.position.x)**2+(e.threeBoid.position.y-this.threeBoid.position.y)**2+(e.threeBoid.position.z-this.threeBoid.position.z)**2)}getPosition(){return this.threeBoid.position}update(e){l(this,m,L).call(this),l(this,y,I).call(this,e),l(this,B,N).call(this,e),l(this,g,T).call(this,e),this.acceleration.multiplyScalar(this.mass),this.velocity.add(this.acceleration),this.velocity.clampLength(0,1),this.threeBoid.position.add(this.velocity),this.acceleration.set(0,0,0)}getDirectionVector(){return this.velocity.clone().normalize()}}m=new WeakSet,L=function(){const e=40,n=1;this.threeBoid.position.x>=e&&(this.acceleration.x-=n),this.threeBoid.position.x<=-e&&(this.acceleration.x+=n),this.threeBoid.position.y>=e&&(this.acceleration.y-=n),this.threeBoid.position.y<=-e&&(this.acceleration.y+=n),this.threeBoid.position.z>=e&&(this.acceleration.z-=n),this.threeBoid.position.z<=-e&&(this.acceleration.z+=n)},g=new WeakSet,T=function(e){const n=10,c=.03;let i=new t.Vector3,o=new t.Vector3,r=0;for(let v of e)if(v!==this){let D=this.getDistance(v);D<=n&&(o=this.threeBoid.position.clone(),o.sub(v.threeBoid.position).divideScalar(D).multiplyScalar(n),i.add(o),r++)}r&&(i.multiplyScalar(c),this.acceleration.add(i))},y=new WeakSet,I=function(e){const n=1,c=20;let i=0,o=new t.Vector3(0,0,0);for(let r of e)r!==this&&this.getDistance(r)<=c&&(o.add(r.velocity),i++);i&&(o.divideScalar(i),o.multiplyScalar(n),this.acceleration.add(o))},B=new WeakSet,N=function(e){const n=10,c=1;let i=0,o=new t.Vector3(0,0,0);for(let r of e)r!==this&&this.getDistance(r)<=n&&(o.add(r.threeBoid.position),i++);if(i){o.divideScalar(i);const r=this.threeBoid.position.clone();r.sub(o).multiplyScalar(c),this.acceleration.sub(r)}};function z(s){const e=document.getElementById(s);return e.width=window.innerWidth/2,e.height=window.innerHeight/2,e.style.width=e.width,e.style.height=e.height,e}const S=z("renderScreen"),M=z("secondScreen"),a=new t.Scene;a.background=new t.Color(11184810);const f=new t.PerspectiveCamera(75,S.width/S.height,.1,1e3);f.position.z=-50;const w=new t.WebGLRenderer({canvas:S});w.setSize(window.innerWidth/2,window.innerHeight/2);const p=new t.WebGLRenderer({canvas:M});p.setSize(window.innerWidth/2,window.innerHeight/2);const R=new t.AmbientLight(16777215,.5),x=new t.DirectionalLight(16777215,.5);x.position.set(0,100,0);new t.DirectionalLightHelper(x);a.add(R,x);new E(f,w.domElement);window.addEventListener("resize",()=>{w.setSize(window.innerWidth/2,window.innerHeight/2),f.aspect=window.innerWidth/window.innerHeight,f.updateProjectionMatrix(),p.setSize(window.innerWidth/2,window.innerHeight/2),d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix()});const P=new t.Mesh(new t.BoxBufferGeometry(100,100,100),new t.MeshBasicMaterial({color:11141120,wireframe:!1,side:t.DoubleSide}));new t.BoxHelper(P);new t.AxesHelper(7);new t.GridHelper(10,20);const d=new t.PerspectiveCamera(75,M.width/M.height,.1,1e3);new E(d,p.domElement);const V=new b(a),F=666;let u=[];for(let s=0;s<F;s++)u.push(new b(a));function A(){V.update(u),d.position.copy(V.threeBoid.position),d.rotation.setFromVector3(V.getDirectionVector()),u.forEach(s=>s.update(u)),w.render(a,f),p.render(a,d),requestAnimationFrame(A)}window.onload=A;
