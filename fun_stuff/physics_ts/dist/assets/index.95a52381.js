import{c as a,S as D,A as M,D as k,O as H,W as I,B as G,C as W,M as N,a as q}from"./vendor.fefae76c.js";const P=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerpolicy&&(s.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?s.credentials="include":t.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}};P();let d,x,h,u;const f=3,v=document.getElementById("score"),T=document.getElementById("reset");T.onclick=()=>C();const g=1;let c=[],B=[],b;function S(){b=0,L=!1,c=[],B=[],v.textContent="0",u=new a.exports.World,u.gravity.set(0,-2e-4,0),u.broadphase=new a.exports.NaiveBroadphase,u.solver.iterations=40,x=new D;const e=new M(16777215,.6),o=new k(16777215,.6);o.position.set(10,20,0),x.add(e,o);const n=10,i=n*(window.innerHeight/window.innerWidth);d=new H(n/-2,n/2,i/2,i/-2,.1,1e3),d.position.set(4,4,4),d.lookAt(0,0,0),h=new I({antialias:!0}),h.setSize(window.innerWidth,window.innerHeight),z(0,0,f,f,"x"),z(-10,0,f,f,"x"),h.render(x,d),document.body.appendChild(h.domElement)}function z(e,o,n,i,t){const s=g*c.length,r=A(e,s,o,n,i,!1);r.axis=t,c.push(r)}function A(e,o,n,i,t,s){const r=new G(i,g,t),l=s?new W(`hsl(${30+(c.length-1)*4}, 100%, 50%)`):new W(`hsl(${30+c.length*4}, 100%, 50%)`),w=new N({color:l}),p=new q(r,w);p.position.set(e,o,n),x.add(p);const j=new a.exports.Box(new a.exports.Vec3(i/2,g/2,t/2));let m=s?5:0;m*=i/f,m*=t/f;const y=new a.exports.Body({mass:m,shape:j});return y.position.set(e,o,n),u.addBody(y),{threejs:p,cannonjs:y,width:i,depth:t}}function X(e){const o=.15,n=c[c.length-1];n.threejs.position[n.axis]+=o,n.cannonjs.position[n.axis]+=o,d.position.y<g*(c.length-2)+4&&(d.position.y+=o);const i=e-b;R(i),h.render(x,d),b=e}function R(e){u.step(e),B.forEach(o=>{o.threejs.position.copy(o.cannonjs.position),o.threejs.quaternion.copy(o.cannonjs.quaternion)})}let L=!1;function V(e,o,n,i){const t=g*(c.length-1),s=A(e,t,o,n,i,!0);B.push(s)}function Z(e,o,n,i){const t=e.axis,s=t==="x"?o:e.width,r=t==="z"?o:e.depth;e.width=s,e.depth=r,e.threejs.scale[t]=o/n,e.threejs.position[t]-=i/2,e.cannonjs.position[t]-=i/2;const l=new a.exports.Box(new a.exports.Vec3(s/2,g,r/2));e.cannonjs.shapes=[],e.cannonjs.addShape(l)}window.addEventListener("click",()=>{if(!L)h.setAnimationLoop(X),L=!0;else{const e=c[c.length-1],o=c[c.length-2],n=e.axis,i=e.threejs.position[n]-o.threejs.position[n],t=Math.abs(i),s=n==="x"?e.width:e.depth,r=s-t;if(r>0){v.textContent=(parseInt(v.textContent)+1).toString(),Z(e,r,s,i);const l=e.width,w=e.depth,p=(r/2+t/2)*Math.sign(i),j=n=="x"?e.threejs.position.x+p:e.threejs.position.x,m=n=="z"?e.threejs.position.z+p:e.threejs.position.z;V(j,m,n==="x"?t:l,n==="z"?t:w);const E=n==="x"?e.threejs.position.x:-10,O=n==="z"?e.threejs.position.z:-10;z(E,O,l,w,n==="x"?"z":"x")}}});window.addEventListener("keydown",e=>{e.key==="r"&&C()});function C(){h.setAnimationLoop(null),setTimeout(S,1e3)}S();
