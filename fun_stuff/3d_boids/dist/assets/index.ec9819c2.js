var O=(r,e,o)=>{if(!e.has(r))throw TypeError("Cannot "+o)};var l=(r,e,o)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,o)};var f=(r,e,o)=>(O(r,e,"access private method"),o);import*as s from"https://cdn.skypack.dev/three";import{OrbitControls as z}from"https://cdn.skypack.dev/three/examples/jsm/controls/OrbitControls";import{S as W,M as L,R as T,V as c,a as V}from"./vendor.14cde37c.js";const I=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function o(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(t){if(t.ep)return;t.ep=!0;const i=o(t);fetch(t.href,i)}};I();const N=new W(.5),R=new L({color:43520});new T(new c(0,0,0),new c(0,0,0),.1,1e3);var g,P,y,F,B,G,v,k;class A{constructor(e){l(this,g);l(this,y);l(this,B);l(this,v);this.scene=e,this.velocity=new c(0,0,0),this.acceleration=new c(Math.random()*40-20,Math.random()*40-20,Math.random()*40-20),this.mass=.1,this.threeBoid=new V(N,R),this.threeBoid.position.set(Math.random()*8-4,Math.random()*8-4,Math.random()*8-4),this.scene.add(this.threeBoid)}getDistance(e){return Math.sqrt((e.threeBoid.position.x-this.threeBoid.position.x)**2+(e.threeBoid.position.y-this.threeBoid.position.y)**2+(e.threeBoid.position.z-this.threeBoid.position.z)**2)}getPosition(){return this.threeBoid.position}update(e){f(this,g,P).call(this),f(this,B,G).call(this,e),f(this,v,k).call(this,e),f(this,y,F).call(this,e),this.acceleration.multiplyScalar(this.mass),this.velocity.add(this.acceleration),this.velocity.clampLength(0,1),this.threeBoid.position.add(this.velocity),this.acceleration.set(0,0,0)}getDirectionVector(){return this.velocity.clone().normalize()}}g=new WeakSet,P=function(){const e=40,o=1;this.threeBoid.position.x>=e&&(this.acceleration.x-=o),this.threeBoid.position.x<=-e&&(this.acceleration.x+=o),this.threeBoid.position.y>=e&&(this.acceleration.y-=o),this.threeBoid.position.y<=-e&&(this.acceleration.y+=o),this.threeBoid.position.z>=e&&(this.acceleration.z-=o),this.threeBoid.position.z<=-e&&(this.acceleration.z+=o)},y=new WeakSet,F=function(e){const o=10,a=.03;let t=new c,i=new c,n=0;for(let S of e)if(S!==this){let b=this.getDistance(S);b<=o&&(i=this.threeBoid.position.clone(),i.sub(S.threeBoid.position).divideScalar(b).multiplyScalar(o),t.add(i),n++)}n&&(t.multiplyScalar(a),this.acceleration.add(t))},B=new WeakSet,G=function(e){const o=1,a=20;let t=0,i=new c(0,0,0);for(let n of e)n!==this&&this.getDistance(n)<=a&&(i.add(n.velocity),t++);t&&(i.divideScalar(t),i.multiplyScalar(o),this.acceleration.add(i))},v=new WeakSet,k=function(e){const o=10,a=1;let t=0,i=new c(0,0,0);for(let n of e)n!==this&&this.getDistance(n)<=o&&(i.add(n.threeBoid.position),t++);if(t){i.divideScalar(t);const n=this.threeBoid.position.clone();n.sub(i).multiplyScalar(a),this.acceleration.sub(n)}};function C(r){const e=document.getElementById(r);return e.width=window.innerWidth/2,e.height=window.innerHeight/2,e.style.width=e.width,e.style.height=e.height,e}const M=C("renderScreen"),x=C("secondScreen"),d=new s.Scene;d.background=new s.Color(11184810);const w=new s.PerspectiveCamera(75,M.width/M.height,.1,1e3);w.position.z=-50;const p=new s.WebGLRenderer({canvas:M});p.setSize(window.innerWidth/2,window.innerHeight/2);const m=new s.WebGLRenderer({canvas:x});m.setSize(window.innerWidth/2,window.innerHeight/2);const j=new s.AmbientLight(16777215,.5),D=new s.DirectionalLight(16777215,.5);D.position.set(0,100,0);new s.DirectionalLightHelper(D);d.add(j,D);new z(w,p.domElement);window.addEventListener("resize",()=>{p.setSize(window.innerWidth/2,window.innerHeight/2),w.aspect=window.innerWidth/window.innerHeight,w.updateProjectionMatrix(),m.setSize(window.innerWidth/2,window.innerHeight/2),h.aspect=window.innerWidth/window.innerHeight,h.updateProjectionMatrix()});const U=new s.Mesh(new s.BoxBufferGeometry(100,100,100),new s.MeshBasicMaterial({color:11141120,wireframe:!1,side:s.DoubleSide}));new s.BoxHelper(U);new s.AxesHelper(7);new s.GridHelper(10,20);const h=new s.PerspectiveCamera(75,x.width/x.height,.1,1e3);new z(h,m.domElement);const E=new A(d),q=666;let u=[];for(let r=0;r<q;r++)u.push(new A(d));function H(){E.update(u),h.position.copy(E.threeBoid.position),h.rotation.setFromVector3(E.getDirectionVector()),u.forEach(r=>r.update(u)),p.render(d,w),m.render(d,h),requestAnimationFrame(H)}window.onload=H;
